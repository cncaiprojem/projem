# =================================================================================
# ULTRA-ENTERPRISE PRODUCTION ENVIRONMENT CONFIGURATION - Task 3.12
# =================================================================================
# KRİTİK: Bu dosya Task 3.12 ile güncellenen production environment konfigürasyonu
# Tüm güvenlik ayarları banking-grade ve Turkish KVKV uyumluluğunu sağlar
# =================================================================================

# ===================================================================
# CORE ENVIRONMENT CONFIGURATION (Task 3.12) - CRITICAL
# ===================================================================

# Environment mode - PRODUCTION ONLY
ENV=production

# Development mode - MUST be false in production
DEV_MODE=false

# Debug mode - MUST be false in production for security
DEBUG=false

# Production hardening - MUST be enabled
PRODUCTION_HARDENING_ENABLED=true

# Security level - Maximum enforcement
SECURITY_LEVEL=maximum

# ===================================================================
# DEVELOPMENT MODE FEATURES (ALL DISABLED IN PRODUCTION)
# ===================================================================

# Authentication bypass - MUST be false in production
DEV_AUTH_BYPASS=false

# Detailed error messages - MUST be false to prevent information disclosure
DEV_DETAILED_ERRORS=false

# API response annotations - MUST be false in production
DEV_RESPONSE_ANNOTATIONS=false

# Mock external services - MUST be false in production
DEV_MOCK_EXTERNAL_SERVICES=false

# CSRF localhost bypass - MUST be false in production
CSRF_DEV_LOCALHOST_BYPASS=false

# ===================================================================
# PRODUCTION HARDENING (ALL ENABLED FOR SECURITY)
# ===================================================================

# Force HTTPS redirects - MANDATORY for production security
PROD_FORCE_HTTPS=true

# Mask error details - MANDATORY to prevent information disclosure
PROD_MASK_ERROR_DETAILS=true

# Strict cookie security - MANDATORY for banking-grade security
PROD_STRICT_COOKIES=true

# Disable debug endpoints - MANDATORY in production
PROD_DISABLE_DEBUG_ENDPOINTS=true

# ===================================================================
# APPLICATION CORE SETTINGS - SECURE PRODUCTION VALUES
# ===================================================================

# Main application secret - MUST be changed from default
# Generate with: openssl rand -hex 32
SECRET_KEY=CHANGE-THIS-TO-CRYPTOGRAPHICALLY-SECURE-PRODUCTION-SECRET-KEY-MINIMUM-32-CHARS

# Server ports (typically behind reverse proxy in production)
API_PORT=8000
WEB_PORT=3000

# ===================================================================
# DATABASE CONFIGURATION - PRODUCTION SECURITY
# ===================================================================

# PostgreSQL production configuration
POSTGRES_USER=freecad_prod
POSTGRES_PASSWORD=CHANGE-THIS-TO-SECURE-PRODUCTION-PASSWORD
POSTGRES_DB=freecad_prod
POSTGRES_PORT=5432
DATABASE_URL=postgresql+psycopg2://freecad_prod:SECURE-PROD-PASSWORD@prod-postgres:5432/freecad_prod

# Production database performance and security
DB_CONNECTION_POOL_SIZE=50
DB_CONNECTION_TIMEOUT=10
DB_QUERY_TIMEOUT=30

# ===================================================================
# REDIS CONFIGURATION - PRODUCTION SECURITY
# ===================================================================

# Redis production configuration with authentication
REDIS_URL=redis://:SECURE-REDIS-PASSWORD@prod-redis:6379/0
REDIS_PORT=6379
REDIS_CONNECTION_POOL_SIZE=100
REDIS_CONNECTION_TIMEOUT=2

# ===================================================================
# JWT & AUTHENTICATION CONFIGURATION - BANKING GRADE
# ===================================================================

# JWT production configuration - CRITICAL SECURITY
# Generate separate key with: openssl rand -hex 64
JWT_SECRET_KEY=CHANGE-THIS-TO-SEPARATE-CRYPTOGRAPHICALLY-SECURE-JWT-SECRET-KEY-MINIMUM-64-CHARS
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15  # Shorter in production for security
JWT_REFRESH_TOKEN_EXPIRE_DAYS=1  # Shorter in production
JWT_ISSUER=freecad-ultra-enterprise-prod
JWT_AUDIENCE=freecad-banking-users-prod

# Session production configuration
SESSION_TIMEOUT_MINUTES=15  # Shorter timeout in production
SESSION_ABSOLUTE_TIMEOUT_MINUTES=240  # 4 hours maximum
SESSION_COOKIE_NAME=__Secure-session_id  # Secure prefix
SESSION_COOKIE_SECURE=true  # MANDATORY for HTTPS-only
SESSION_COOKIE_HTTPONLY=true  # MANDATORY to prevent XSS
SESSION_COOKIE_SAMESITE=strict  # MANDATORY for CSRF protection

# Legacy compatibility (shorter values for production security)
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_MINUTES=1440

# ===================================================================
# CSRF PROTECTION CONFIGURATION - BANKING GRADE
# ===================================================================

# CSRF production secret - MUST be changed from default
# Generate with: openssl rand -hex 32
CSRF_SECRET_KEY=CHANGE-THIS-TO-CRYPTOGRAPHICALLY-SECURE-CSRF-SECRET-KEY-MINIMUM-32-CHARS

# CSRF strict production settings
CSRF_TOKEN_LIFETIME_SECONDS=3600  # 1 hour (shorter for security)
CSRF_RATE_LIMIT_PER_MINUTE=30  # Stricter rate limiting
CSRF_REQUIRE_AUTH=true  # MANDATORY authentication requirement

# ===================================================================
# CORS CONFIGURATION - STRICT PRODUCTION SECURITY
# ===================================================================

# CORS strict production settings - NEVER use wildcards
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=Accept,Accept-Language,Content-Language,Content-Type,Authorization,X-Requested-With,X-CSRF-Token,X-Request-ID
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=1800  # 30 minutes cache

# ===================================================================
# RATE LIMITING CONFIGURATION - STRICT PRODUCTION LIMITS
# ===================================================================

# Production rate limiting - Strict but usable
RATE_LIMIT_GLOBAL=500/hour  # Per IP global limit
RATE_LIMIT_AUTH=5/minute  # Strict auth endpoint limiting
RATE_LIMIT_API=150/hour  # API endpoint limiting

# Brute force protection - Banking grade
BRUTE_FORCE_MAX_ATTEMPTS=3  # Very strict
BRUTE_FORCE_LOCKOUT_DURATION=900  # 15 minutes
BRUTE_FORCE_RESET_TIME=3600  # 1 hour reset

# ===================================================================
# SECURITY HEADERS CONFIGURATION - MAXIMUM SECURITY
# ===================================================================

# All security headers enabled for production
SECURITY_HSTS_ENABLED=true  # MANDATORY for HTTPS enforcement
SECURITY_HSTS_MAX_AGE=31536000  # 1 year with preload
SECURITY_CSP_ENABLED=true  # Content Security Policy
SECURITY_CSP_REPORT_URI=https://yourdomain.com/api/security/csp-report
SECURITY_INPUT_VALIDATION_ENABLED=true  # Input validation
SECURITY_XSS_DETECTION_ENABLED=true  # XSS detection

# ===================================================================
# OAUTH2 & GOOGLE OIDC CONFIGURATION - PRODUCTION
# ===================================================================

# Google OAuth production configuration
GOOGLE_OAUTH_ENABLED=true
GOOGLE_CLIENT_ID=your-production-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-production-google-client-secret
GOOGLE_DISCOVERY_URL=https://accounts.google.com/.well-known/openid-configuration

# OAuth strict production settings
OAUTH_STATE_EXPIRE_MINUTES=10  # Shorter expiry for security
OAUTH_PKCE_VERIFIER_EXPIRE_MINUTES=10
OAUTH_CALLBACK_TIMEOUT_SECONDS=20  # Shorter timeout

# ===================================================================
# TURKISH KVKV COMPLIANCE CONFIGURATION - MANDATORY
# ===================================================================

# KVKV compliance - All features MANDATORY in production
KVKV_DATA_RETENTION_DAYS=2555  # 7 years for banking compliance
KVKV_PII_MASKING_ENABLED=true  # MANDATORY for personal data protection
KVKV_AUDIT_LOG_ENABLED=true  # MANDATORY for KVKV compliance
KVKV_CONSENT_REQUIRED=true  # MANDATORY user consent

# ===================================================================
# AUDIT & SECURITY EVENT LOGGING - BANKING COMPLIANCE
# ===================================================================

# All audit features MANDATORY in production
AUDIT_LOG_ENABLED=true  # MANDATORY for compliance
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years banking compliance
AUDIT_HASH_CHAIN_ENABLED=true  # MANDATORY for integrity
AUDIT_REAL_TIME_MONITORING=true  # MANDATORY for security
SECURITY_EVENTS_ENABLED=true  # MANDATORY for threat detection

# ===================================================================
# STORAGE & FILE HANDLING - PRODUCTION SECURITY
# ===================================================================

# Production S3/MinIO configuration with security
AWS_ACCESS_KEY_ID=PROD-S3-ACCESS-KEY-ID
AWS_SECRET_ACCESS_KEY=PROD-S3-SECRET-ACCESS-KEY
AWS_S3_ENDPOINT=https://s3.your-region.amazonaws.com
AWS_S3_REGION=eu-central-1  # European region for GDPR/KVKV compliance
S3_BUCKET_NAME=prod-freecad-artifacts

# MinIO production credentials (if using MinIO instead of S3)
MINIO_ROOT_USER=prod_minio_admin
MINIO_ROOT_PASSWORD=SECURE-MINIO-PRODUCTION-PASSWORD

# ===================================================================
# FREECAD & APPLICATION SPECIFIC - PRODUCTION OPTIMIZED
# ===================================================================

# FreeCAD production configuration
FREECADCMD_PATH=/usr/bin/FreeCADCmd
FREECAD_TIMEOUT_SECONDS=600  # Shorter timeout for production
FREECAD_ASM4_REQUIRED=true

# FreeCAD production performance
FREECAD_QUEUE_CONCURRENCY=4  # Higher concurrency for production
TIMEOUT_S=600

# Simulation production settings
SIM_RESOLUTION_MM_DEFAULT=0.5  # Higher resolution for production
SIM_TIMEOUT_S=800
SIM_QUEUE_CONCURRENCY=2

# ===================================================================
# RABBITMQ & CELERY CONFIGURATION - PRODUCTION CLUSTER
# ===================================================================

# RabbitMQ production cluster configuration
RABBITMQ_USER=freecad_prod
RABBITMQ_PASS=SECURE-RABBITMQ-PRODUCTION-PASSWORD
RABBITMQ_VHOST=/prod
RABBITMQ_PORT=5672
RABBITMQ_MGMT_PORT=15672
RABBITMQ_URL=amqp://freecad_prod:SECURE-PASSWORD@prod-rabbitmq-cluster:5672/prod

# Celery production configuration
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TASK_EAGER_PROPAGATES=false  # Different setting for production
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_TASK_ACKS_LATE=true
CELERY_TASK_REJECT_ON_WORKER_LOST=true
CELERY_BROKER_POOL_LIMIT=20  # Higher pool for production

# Queue priorities (production optimized)
QUEUE_PRIORITY_URGENT=9
QUEUE_PRIORITY_HIGH=7
QUEUE_PRIORITY_NORMAL=5
QUEUE_PRIORITY_LOW=3
QUEUE_PRIORITY_BACKGROUND=1

# ===================================================================
# AI & MODEL MANAGEMENT - PRODUCTION SECURITY
# ===================================================================

# OpenAI production configuration
OPENAI_API_KEY=SECURE-OPENAI-PRODUCTION-API-KEY

# Azure OpenAI production configuration
AZURE_OPENAI_ENDPOINT=https://your-prod-openai.openai.azure.com/
AZURE_OPENAI_API_KEY=SECURE-AZURE-OPENAI-PRODUCTION-KEY
AZURE_OPENAI_API_VERSION=2024-06-01

# Production model management
MODEL_POLICY=quality_first
DEFAULT_MODEL=gpt-4o
FALLBACK_MODEL=gpt-4o-mini
ALLOWED_MODELS=gpt-4o,gpt-4o-mini

# ===================================================================
# MONITORING & OBSERVABILITY - PRODUCTION GRADE
# ===================================================================

# OpenTelemetry production configuration
OTEL_EXPORTER_OTLP_ENDPOINT=https://prod-otel-collector:4317
OTEL_SERVICE_NAME=freecad-ultra-enterprise-prod

# Sentry production monitoring
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# ===================================================================
# UI & BRANDING - PRODUCTION
# ===================================================================

# Production branding
BRAND_NAME=FreeCAD Ultra-Enterprise Production
BRAND_LOGO_PATH=/static/prod-logo.png
PDF_MAX_MB=50  # Higher limit for production
PUBLIC_WEB_BASE_URL=https://yourdomain.com

# Production toolbits
TOOLBITS_ROOT=/opt/freecad/toolbits

# ===================================================================
# NEXT.JS FRONTEND CONFIGURATION - PRODUCTION
# ===================================================================

# Production Node.js environment
NODE_ENV=production

# Frontend production configuration
NEXT_PUBLIC_API_BASE_URL=https://api.yourdomain.com
NEXT_PUBLIC_DEV_AUTH_BYPASS=false  # MUST be false

# ===================================================================
# PRODUCTION SECURITY VALIDATION
# ===================================================================

# IMPORTANT PRODUCTION SECURITY CHECKLIST:
# ✅ ENV=production
# ✅ DEV_MODE=false
# ✅ DEBUG=false
# ✅ PRODUCTION_HARDENING_ENABLED=true
# ✅ All secret keys changed from defaults
# ✅ HTTPS enforcement enabled
# ✅ Secure cookies enabled
# ✅ Authentication bypass disabled
# ✅ Error masking enabled
# ✅ Debug endpoints disabled
# ✅ CSRF protection maximized
# ✅ Rate limiting strict
# ✅ CORS origins specific (no wildcards)
# ✅ KVKV compliance fully enabled
# ✅ Audit logging mandatory features enabled
# ✅ Database passwords secure
# ✅ Redis authentication enabled
# ✅ RabbitMQ credentials secure
# ✅ External service credentials secure

# TURKISH KVKV COMPLIANCE CHECKLIST:
# ✅ KVKV_AUDIT_LOG_ENABLED=true
# ✅ KVKV_PII_MASKING_ENABLED=true
# ✅ KVKV_CONSENT_REQUIRED=true
# ✅ KVKV_DATA_RETENTION_DAYS=2555 (7 years)
# ✅ AUDIT_LOG_ENABLED=true
# ✅ AUDIT_HASH_CHAIN_ENABLED=true
# ✅ SECURITY_EVENTS_ENABLED=true

# BANKING-GRADE SECURITY FEATURES:
# ✅ Ultra-short session timeouts
# ✅ Minimal token expiry times
# ✅ Maximum rate limiting
# ✅ Comprehensive audit trail
# ✅ Real-time threat monitoring
# ✅ Data encryption in transit and at rest
# ✅ Multi-layer security validation
# ✅ Zero-trust production environment

# PRODUCTION DEPLOYMENT NOTES:
# 1. All passwords and secrets MUST be generated uniquely
# 2. Use external secret management (Azure Key Vault, AWS Secrets Manager)
# 3. Enable WAF (Web Application Firewall) in front of the application
# 4. Use TLS 1.3 for all communications
# 5. Enable database encryption at rest
# 6. Regular security audits and penetration testing
# 7. Monitor all audit logs in real-time SIEM
# 8. Implement backup and disaster recovery procedures
# 9. Follow Turkish banking regulations and KVKV requirements
# 10. Regular compliance audits and documentation